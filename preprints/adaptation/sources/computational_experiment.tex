%!TEX root = ../main.tex

\section{Вычислительный эксперимент}

\subsection{Параметры модели, краевые условия}

Была создана программа, реализующая в рамках разностной схе\forcehyphenation мы \eqref{sch:borders},~\eqref{sch:transition},~\eqref{sch:time_step_min_max} перечисленные ранее алгоритмы адаптации временного шага: по фазовому полю \eqref{sch:time_step_phi}, по энергии \eqref{sch:time_step_energy} и по устойчивости \eqref{sch:time_step_stability}.

Будем использовать параметры модели, отражающие реальный физический эксперимент: см. табл. \ref{tab:parameters}. Часть параметров ($| \nabla \Phi|$, $\epsilon_0$) являются полноценными физическими величинами, часть ($\Gamma$, $m$) могут быть подобраны для согласования модели с результатами эксперимента. Чертой отделены параметры, которые либо происходят из связанных с диффузной границей допущений ($l$, $\delta$), либо описывают расчетную сетку.

\begin{table}[!t]
\captionsetup{justification=raggedright,singlelinecheck=false}
\caption[]{Параметры модели в расчете}
\centering
\begin{tabular}{|l|c|l|}
	\hline
	Название & Параметр & Значение \\
	\hline
	электрическое напряжение		& $|\nabla \Phi|$	& $5.625 \cdot 10^6 \; \unitV / \unitm$							\\
	энергия роста ед. длины канала	& $\Gamma$			& $8.118 \cdot 10^{-10} \; \unitJ / \unitm$						\\
	диэлектрическая проницаемость	& $\epsilon_0$		& $2.301 \cdot 10^{-11} \; \unitC^2 / (\unitJ \cdot \unitm)$	\\
	подвижность						& $m$				& $12 \; \unitm^3 / (\unitJ \cdot \units)$						\\
	\hline
	характерная толщина границы		& $l$ 				& $1.5 \cdot 10^{-6} \; \unitm$									\\
	регуляризующий параметр 		& $\delta$			& $10^{-3}$														\\
	размер образца					& $W$				& $3.2 \cdot 10^{-5} \; \unitm$									\\
	продолжительность опыта			& $T$				& $2 \cdot 10^{-3} \; \units$									\\
	шаг по пространству				& $h$				& $5 \cdot 10^{-7} \; \unitm$									\\
	минимальный шаг по времени		& $\taumin$		& $10^{-10} \; \units$											\\
	максимальный шаг по времени		& $\taumax$		& $\leqslant 6.42 \cdot 10^{-6} \; \units$						\\
	\hline
\end{tabular}
\label{tab:parameters}
\end{table}

Число узлов сетки по пространству $N_x \equiv M = 64$, по времени -- $312 \hm \leqslant N_t \leqslant 2 \cdot 10^7$.

При подстановке значений параметров в условие \eqref{cond:stability} устойчивости разностной схемы получаем $\tau \leqslant \min(2.86 \cdot 10^{-10}, 6.42 \cdot 10^{-6}) \, \units$. Неравенство с первым аргументом минимума является ограничением, происходящим из свойств функции $F(\phi)$ (см. формулу \eqref{cond:stability_first}). Оно может быть ослаблено в зависимости от значений $\phi_j^k$ на текущем временном слое. Неравенство со вторым аргументом носит безусловный характер. Поэтому качестве $\taumin$ взято значение~$6.42 \cdot 10^{-6} \; \units$; $\taumax = 10^{-10} \; \units$ удовлетворяет обоим неравенствам и может рассматриваться как шаг по времени до введения адаптации.

Зададим следующие краевые условия:
\begin{gather}
	\phi(0, t) = \phi(W, t) = 1, \qquad \phi(x, 0) = \phi_0(x),
	\label{exp:border} \\
	\phi_0(x) = \begin{cases}
		1 - 0.025 \cdot \left( 1 + \cos \left[ \cfrac{\pi}{0.08} \left( \cfrac{x}{W} - \half \right) \right] \right) \text{ при } \cfrac{x}{W} \in [0.42, 0.58]; \\
		1 \text{ иначе}.
	\end{cases}
	\nonumber
\end{gather}
Функция $\phi_0(x)$ отлична от $1$ в небольшой области вокруг $x = W / 2$, где <<прогибается>> как один период синусоиды, достигая минимума $\phi = 0.95$.


\subsection{Структура сетки с переменным шагом по времени}

Итак, на каждом временном слое используется своя величина шага~$\tau^k$. Таким образом, расчетная сетка теряет регулярность по времени, и сравнение разных решений по сеточной норме становится нетривиальной задачей. Введем у нерегулярной сетки определенную структуру, в которой сконцентрируем всю сложность вопроса, избегая при этом использования сеточной интерполяции для результатов расчетов.

Пусть $N = N_{t, max} = T / \taumin \in \Natural$, то есть временной промежуток $[0, T]$ разбит $N + 1$ узлом на $N$ равных отрезков длиной $\taumin$ каждый. Над этим разбиением введем структуру <<типа дерева отрезков>>. Говоря формально, будем считать допустимыми лишь разбиения вида $D = (0, p_1 \taumin, p_2 \taumin, \dots$, $p_{n - 1} \taumin, N \taumin)$, где $p_k \in \Natural_0$, $k = \overline{0, n}$, $p_k$ строго возрастают, $L_k = p_k - p_{k - 1} \hm = 2^{s_k}$, $s_k \in \Natural_0$, и к тому же $p_{k - 1} \divby L_k$.

Описанная структура замечательна тем, что если из любых двух допустимых разбиений $D_1$ и $D_2$ выбрать по интервалу, то либо эти интервалы не пересекаются, либо совпадают, либо один строго вложен в другой. Следовательно, любые два соседних узла объемлющего разбиения $D = D_1 \cap D_2$ (пересечение в смысле множеств) соседствуют также в $D_1$ или в $D_2$ -- в таком ключе $D$ оптимально.

При адаптации шага по времени в разностной схеме \eqref{sch:borders},~\eqref{sch:transition},~\eqref{sch:time_step_min_max} на слое $k$ будем использовать не рассчитываемое $\tau^k$ напрямую, а максимальное ${\tau'}^k = 2^s \taumin \leqslant \tau^k$, $s \in \Natural_0$, к тому же допустимое описанным разбиением <<типа дерева отрезков>> временного промежутка $T$ на $N$ отрезков, а именно:
\begin{gather*}
	p_0 = 0, \quad p_k = p_{k - 1} + 2^{s_k} \leqslant N, \; s_k \in \Natural_0; \\
	{\tau'}^k = 2^{s_k} \cdot \taumin \leqslant \tau^k, \quad p_{k - 1} \divby 2^{s_k}; \\
	s_k \to \max.
\end{gather*}

Для сравнения по равномерной норме $\enorm_{C, h}$ двух сеточных решений~$\phi_1$ и~$\phi_2$ на разбиениях $D_1$ и $D_2$ соответственно ограничим их оба на объемлющем разбиении $D = D_1 \cap D_2$.


\subsection{Результаты расчетов}

На рис. \ref{fig:solution_basic} изображен результат расчета с параметрами из табл. \ref{tab:parameters} и краевыми условиями \eqref{exp:border} для разностной схемы \eqref{sch:transition_old}, \eqref{sch:borders} без адаптации шага по времени. Видно, как из малого начального возмущения фазового поля $\phi$ постепенно растет канал электрического пробоя. В момент времени $t \approx 1.82 \cdot 10^{-3}$ в точке $x = W / 2$ фазовое поле $\phi$  становится мало отличимо от $0$ -- происходит <<пробой насквозь>>. Обратим внимание, что значение фазового поля упало от $\phi \approx 0.6$ до $\phi \approx 0$ менее чем за время $10^{-5}$, то есть $0.5 \%$ от всей продолжительности эксперимента. Далее канал пробоя растет в толщину примерно с постоянной скоростью.

\begin{figure}[!t]
	\centering
	\includegraphics[width=\textwidth]{figures/solution_basic.png}
	\vspace{-0.8cm}
	\caption{Решение задачи (расчет без адаптации)}
	\label{fig:solution_basic}
\end{figure}

Теперь проведем расчеты с той же конфигурацией системы, но используя схему \eqref{sch:borders}, \eqref{sch:transition}, \eqref{sch:time_step_min_max} с переменным шагом по времени для каждого из трех методов адаптации: по фазовому полю~\eqref{sch:time_step_phi}, по энергии~\eqref{sch:time_step_energy}, по устойчивости~\eqref{sch:time_step_stability}.

При слишком больших константах $\tol_1$, $\tol_2$, $\tol_3$ разностная схема закономерно теряет устойчивость и результаты расчетов оказываются неадекватны. В таких случаях либо значения $\phi_j^k$ уходят на бесконечность, либо на графиках явно прослеживаются колебания по узлам сетки.

Для первых двух методов адаптации были опытным путем подобраны минимальные значения констант, при которых описанный вычислительный эксперимент завершается успешно: $\tol_1 = 5 \cdot 10^{-4}$, $\tol_2 = 2 \cdot 10^{-7}$. Адаптация по устойчивости дает адекватный расчет сразу, при $\tol_3 = 1$, что соответствует идее метода.

Провести сравнение решений по стандартной сеточной равномерной норме~$\enorm_{C, h}$ не удается. При введении адаптивного временного шага решение разностной задачи начинает <<отставать>> от исходного -- так проявляет себя ошибка аппроксимации по времени. Так как канал пробоя развивается стремительно, то даже небольшое <<отставание>> приводит к тому, что норма разности решений становится порядка $1$ и не несет значимой информации.

Для сравнения решений будем использовать следующую величину:
\begin{gather*}
	\rho(\phi, \psi) = \max\limits_{k = 0}^n \rho(\phi, \psi; k), \\
	\rho(\phi, \psi; k) = \min\limits_{s = 0}^n \| \phi^k - \psi^s \|_{C, x} = \min\limits_{s = 0}^n \max\limits_{j = 0}^M |\phi_j^k - \psi_j^s|.
\end{gather*}
Формула означает, что каждому моменту времени $t_{1, k}$ первого расчета сопоставляется момент времени $t_{2, s}$ второго расчета, в который сеточное решение~$\psi_j^s$ наиболее близко к $\phi_j^k$ по пространственной равномерной норме.

В описанном выше смысле <<отставание>> $\phi_j^k$ от $\psi_j^s$ есть
\begin{gather*}
	\zeta(\phi, \psi) = \max\limits_{k = 0}^n \zeta(\phi, \psi; k), \\
	\zeta(\phi, \psi; k) = t_2 \left( \argmin\limits_{s = 0}^n \| \phi^k - \psi^s \|_{C, x} \right) - t_{1, k}.
\end{gather*}
Относительным отставанием будем называть величину $\zeta(\phi, \psi) / T$, где $T$ -- длительность эксперимента.

На рис. \ref{fig:peak_error} и \ref{fig:peak_lag} показаны графики отклонения $\rho(\phi, \psi; k)$ и отстава\forcehyphenation ния $\zeta(\phi, \psi; k)$ в зависимости от $t_k$ для расчетов с максимальным наблюдаемым ускорением для каждого из трех методов адаптации. Ускорением считается уменьшение числа временных шагов после введения адаптивного шага; $\phi$ обозначает расчет с адаптией, $\psi$ -- исходный, эталонный, расчет. При построении графика $\rho(\phi, \psi; k)$ был применен фильтр оконного минимума для избавления от сеточных артефактов, связанных, по-видимому, с используемым экономичным сохранением результатов расчетов. Такой прием уместен, поскольку порядок ошибки решения куда более важен, чем ее точное значение.

\begin{figure}[!tp]
	\centering
	\includegraphics[width=\textwidth]{figures/adaptation_peak_error.png}
	\vspace{-0.8cm}
	\caption{Отклонение $\rho(\phi, \psi; k)$ решения с адаптацией от исходного решения}
	\label{fig:peak_error}
	\vspace{1cm}

	\includegraphics[width=\textwidth]{figures/adaptation_peak_lag.png}
	\vspace{-0.8cm}
	\caption{Отставание $\zeta(\phi, \psi; k)$ решения с адаптацией от исходного решения}
	\label{fig:peak_lag}
\end{figure}

В табл. \ref{tab:results_max} перечислены значения $\rho(\phi, \psi)$ и $\zeta(\phi, \psi)$ для указанных выше расчетов. При вычислении максимума в формуле отклонения использовались значения $\rho(\phi, \psi; k)$ с упомянутым оконным фильтром.

В табл. \ref{tab:results_100} перечислены те же характеристики, но для расчетов с ускорением примерно в $100$ раз.

\begin{table}[!t]
\captionsetup{justification=raggedright,singlelinecheck=false}
\caption[]{Результаты расчетов с максимальным ускорением}
\centering
\begin{tabular}{|l|c|c|c|c|}
	\hline
	Тип адаптации & Ускорение (раз) & $\| \phi - \psi \|_{C, h}$ & $\rho(\phi, \psi)$ & $\zeta(\phi, \psi) / T$ \\
	\hline
	по фазовому полю	& $800$		& $0.65$	& $3.64 \cdot 10^{-4}$	& $0.29\%$	\\
	по энергии			& $107$		& $0.68$	& $5.38 \cdot 10^{-4}$	& $0.36\%$	\\
	по устойчивости		& $1474$	& $0.77$	& $1.51 \cdot 10^{-2}$	& $0.71\%$	\\
	\hline
\end{tabular}
\label{tab:results_max}
\end{table}

\begin{table}[!t]
\captionsetup{justification=raggedright,singlelinecheck=false}
\caption[]{Результаты расчетов с ускорением примерно в 100 раз}
\centering
\begin{tabular}{|l|c|c|c|c|}
	\hline
	Тип адаптации & Ускорение (раз) & $\| \phi - \psi \|_{C, h}$ & $\rho(\phi, \psi)$ & $\zeta(\phi, \psi) / T$ \\
	\hline
	по фазовому полю	& $101$	& $0.21$	& $1.23 \cdot 10^{-5}$	& $0.0043\%$	\\
	по энергии			& $101$	& $0.60$	& $3.25 \cdot 10^{-4}$	& $0.19\%$		\\
	по устойчивости		& $100$	& $0.24$	& $2.23 \cdot 10^{-5}$	& $0.0049\%$	\\
	\hline
\end{tabular}
\label{tab:results_100}
\end{table}

Согласно проведенному сравнению, лучше всех себя показал первый метод (он же самый простой) -- адаптация временного шага по фазовому полю. Она показывает высокое ускорение и наименьшую ошибку решения. У адаптации по энергии обе эти характеристики хуже. Адаптация по устойчивости уступает первой в точности, однако имеет определенные особые преимущества: наибольшее пиковое ускорение и возможность использования без подбора коэффициента $\tol_3$ (пусть и при низкой точности решения).